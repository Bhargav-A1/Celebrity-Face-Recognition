<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024b"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S0 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0.8px solid rgb(217, 217, 217); border-bottom: 0.8px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S1 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0.8px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.8px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S4 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.8px solid rgb(217, 217, 217); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent button {    user-select: none;    -webkit-user-select: none;}
.embeddedOutputsErrorElement .eoOutputContent ::selection {}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsWarningElement .eoOutputContent ::selection {}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2023 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: var(--mw-color-matlabWarning) !important;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: var(--mw-color-matlabErrors) !important;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.embeddedOutputsTextElement.activeOutput .eoOutputContent,.embeddedOutputsVariableStringElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
/*embeddedOutputsTextElement has a different dom structure than embeddedOutputsVariableStringElement.Unlike variableString, the text output has both TEXT nodes and elements as children. Hence we needa selector for each.*/.embeddedOutputsTextElement .eoOutputContent::selection,.embeddedOutputsTextElement .eoOutputContent ::selection,.embeddedOutputsVariableStringElement .eoOutputContent ::selection {}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S6 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0.8px solid rgb(217, 217, 217); border-bottom: 0.8px solid rgb(217, 217, 217); border-radius: 0px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0.8px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 0.8px solid rgb(217, 217, 217); border-right: 0.8px solid rgb(217, 217, 217); border-top: 0.8px solid rgb(217, 217, 217); border-bottom: 0.8px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >imageFolder = </span><span style="color: rgb(167, 9, 245);">'/MATLAB Drive/celebrity_data.zip'</span><span >;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >imds = imageDatastore(</span><span style="color: rgb(167, 9, 245);">'Celebrity Images'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'IncludeSubfolders'</span><span >,true, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'LabelSource'</span><span >,</span><span style="color: rgb(167, 9, 245);">'foldernames'</span><span >);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >classNames = categories(imds.Labels)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >numClasses = numel(classNames)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >labelCount = countEachLabel(imds)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >img = readimage(imds,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >size(img)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >numImages = numel(imds.Labels);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >idx = randperm(numImages,16);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >I = imtile(imds,Frames=idx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >imshow(I)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >[imdsTrain,imdsValidation,imdsTest] = splitEachLabel(imds,0.7,0.15,0.15,</span><span style="color: rgb(167, 9, 245);">"randomized"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >net = alexnet;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >inputSize = net.Layers(1).InputSize;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >augimdsTrain = augmentedImageDatastore(inputSize(1:2), imdsTrain, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'DataAugmentation'</span><span >, imageDataAugmenter( </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >        </span><span style="color: rgb(167, 9, 245);">'RandRotation'</span><span >, [-20, 20], </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(0, 128, 19);">        % Random rotation</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >        </span><span style="color: rgb(167, 9, 245);">'RandXTranslation'</span><span >, [-10, 10], </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(0, 128, 19);">    % Horizontal translation</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >        </span><span style="color: rgb(167, 9, 245);">'RandYTranslation'</span><span >, [-10, 10], </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(0, 128, 19);">    % Vertical translation</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >        </span><span style="color: rgb(167, 9, 245);">'RandScale'</span><span >, [0.8, 1.2]), </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(0, 128, 19);">         % Scaling</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ColorPreprocessing'</span><span >, </span><span style="color: rgb(167, 9, 245);">'gray2rgb'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >augimdsVal = augmentedImageDatastore(inputSize(1:2), imdsVal, </span><span style="color: rgb(167, 9, 245);">'ColorPreprocessing'</span><span >, </span><span style="color: rgb(167, 9, 245);">'gray2rgb'</span><span >);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >layers = net.Layers;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >layers(end-2) = fullyConnectedLayer(numel(categories(imdsTrain.Labels)), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'WeightLearnRateFactor'</span><span >,10, </span><span style="color: rgb(167, 9, 245);">'BiasLearnRateFactor'</span><span >,10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >layers(end) = classificationLayer;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >options = trainingOptions(</span><span style="color: rgb(167, 9, 245);">'sgdm'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'InitialLearnRate'</span><span >, 0.0005, </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(0, 128, 19);">  </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'MaxEpochs'</span><span >, 20, </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(0, 128, 19);"> </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Shuffle'</span><span >, </span><span style="color: rgb(167, 9, 245);">'every-epoch'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ValidationData'</span><span >, augimdsVal, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ValidationFrequency'</span><span >, 30, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Verbose'</span><span >, false, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Plots'</span><span >, </span><span style="color: rgb(167, 9, 245);">'training-progress'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >[trainedNet, info] = trainNetwork(augimdsTrain, layers, options);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >[YPred, probs] = classify(trainedNet, augimdsVal);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >YValidation = imdsVal.Labels;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >accuracy = sum(YPred == YValidation) / numel(YValidation);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Validation accuracy: %.2f%%\n'</span><span >, accuracy * 100);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >figure;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >cm = confusionchart(YValidation, YPred);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >cm.Title = </span><span style="color: rgb(167, 9, 245);">'Confusion Matrix for Validation Data'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >cm.XLabel = </span><span style="color: rgb(167, 9, 245);">'Predicted Labels'</span><span >;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >cm.YLabel = </span><span style="color: rgb(167, 9, 245);">'True Labels'</span><span >;</span></span></div><div  class = 'S5'><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAYAAAAeGW/KAAAAAXNSR0IArs4c6QAAA1dJREFUeF7tmDGLMkEMhsdWFKy0EAVrsRUrKwtrwU5b8QeIP0K0sxBb7YT7A1pYiqViJwhaaSVo70cG8pGdnVnXnMfJka3udi+ZyZM3785e5PF4PJRcLxOICLiXmekAAcfjJuCY3AScgOMSYMaJxwk4JgFmmChOwDEJMMMiuVzukclk1Gw2U8lkkpnGHjYajVSv11Pdble12212bswDCUqlkhqPxyoWi7HzYeD9fletVkutViuds1KpeHJut1vVaDRUPp/3rckCBwmHw6EaDAaBBbwDHG7+drvpot4JDvLhHmu1mur3+x5wQft/GdxisdBdencBLvkEdf3bklNKXS4XVa/XdSo6da77uGakXC7rj3wMMjsMz3DUEBrdMEh8v9/rkWw2m2q5XKrT6aRj4KKjih1E6PAcR8U2zq71YKSwMFgLrng8rqbTqSoUCvp3ChyezedzZ7M7nY76+vryjCuuTZWIfwf5PeDgBtDHzSAg3NT5fNaFusC57iMU6ikUrEu9LnCpVEp7D46vuS6AtQnANo4QGwQJvY/6rA+c+XKwmadtVDGp+ZKxeYRZkKkUc/xso4qdp8BNNR8Oh/9wbcZP18E6d7udVi00BgSUTqedLyLfqEJCCgwXwMWDwJkddZkr7d6zokxwON5YJI4mju71etXFwwWqTCQSoU4MdK+mxVDIWL91VNHzotGo73UdBM70KRc46hWu8cHNfhec7Shhqpp6Yjab1Y+Px6PHM81aPODAIMHMsRhqwKgM2+g8UxYFGmT4QQVRAK+Malhw5pTRhppqBpV7wG02G5/5m6NqehR9qz5TnNkIHLugA7itUTbjd+0zLDj6koCfqYXYrMvnceYYVatVDRM7YCaxHTuwCFOJmJt2M+gAah4r6BfDK8eRsF8aQWc32ix4oclHvs0fQtwTcCEg2f5EwAk4JgFmmCjur4KDfxzANZlMmCX+TNhHKw6grddrXXmxWPwoeB8NDoCJ4n5mYn4t68cr7tfIPFlYwDE7I+AEHJMAM0wUJ+CYBJhhojgBxyTADBPFCTgmAWaYKE7AMQkww0RxAo5JgBkmihNwTALMMFGcgGMSYIaJ4gQckwAzTBQn4JgEmGGiOAHHJMAME8UJOCYBZpgoTsAxCTDD/gFGRpulNVxodQAAAABJRU5ErkJggg=="></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Precision and Recall</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >confMat = confusionmat(YValidation, YPred);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >precision = diag(confMat) ./ sum(confMat, 2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >recall = diag(confMat) ./ sum(confMat, 1)';</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Display Precision and Recall</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Precision for each class:\n'</span><span >);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="C87325C8" prevent-scroll="true" data-testid="output_1" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Precision for each class:</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >disp(precision);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="E7A55BF4" prevent-scroll="true" data-testid="output_2" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="76" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">    1.0000
    0.8182
    1.0000
    1.0000
    0.6000</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Recall for each class:\n'</span><span >);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="8BFC292A" prevent-scroll="true" data-testid="output_3" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Recall for each class:</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >disp(recall);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="AC4C32D4" prevent-scroll="true" data-testid="output_4" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="76" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">    1.0000
    1.0000
    0.6875
    0.9167
    1.0000</div></div></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >overallPrecision = mean(precision);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >overallRecall = mean(recall);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Overall Precision: %.2f%%\n'</span><span >, overallPrecision * 100);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="50BCDBA5" prevent-scroll="true" data-testid="output_5" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Overall Precision: 88.36%</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Overall Recall: %.2f%%\n'</span><span >, overallRecall * 100);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="2E684B96" prevent-scroll="true" data-testid="output_6" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Overall Recall: 92.08%</div></div></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >augimdsTest = augmentedImageDatastore(inputSize(1:2), imdsTest, </span><span style="color: rgb(167, 9, 245);">'ColorPreprocessing'</span><span >, </span><span style="color: rgb(167, 9, 245);">'gray2rgb'</span><span >);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >YPredTestSet = classify(trainedNet, augimdsTest);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >YTest = imdsTest.Labels;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >estAccuracy = sum(YPredTestSet == YTest) / numel(YTest);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Test accuracy: %.2f%%\n'</span><span >, testAccuracy * 100);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="01608834" prevent-scroll="true" data-testid="output_7" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Test accuracy: 89.74%</div></div></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >figure;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >cmTest = confusionchart(YTest, YPredTestSet);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >cmTest.Title = </span><span style="color: rgb(167, 9, 245);">'Confusion Matrix for Test Data'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >cmTest.XLabel = </span><span style="color: rgb(167, 9, 245);">'Predicted Labels'</span><span >;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >cmTest.YLabel = </span><span style="color: rgb(167, 9, 245);">'True Labels'</span><span >;</span></span></div><div  class = 'S5'><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAYAAAAeGW/KAAAAAXNSR0IArs4c6QAAA4hJREFUeF7tmbFqKlEQhmfbYMBKC7GwVUwpVlZ5goCdASuxV3wBSSNqYaOmjZUBawsLG0FsQ6wEC7EwlaDYbpjDHTme7Gp29uZGLrNNzNmdPTvf/PPPmli2bdsgh2cCloDzzEwFCDgeNwHH5CbgBByXADNOPE7AMQkww0RxAo5JgBnmWXHlchkGg4HaLp1Ow/PzMwQCAfV7p9OBWq2mPkejUXh9fYVQKMR8NOcw2qNSqUCxWGTfW8/j4eEB6vW6p3v5And7ewu9Xg+SyaTaVH8Yr+BGoxEMh8OLCfwNcLhXoVA4gvqn4OLxOMznc6W4+/t7+Pj4gGw2C6vVyrPiCAYnAU8y+XMxgfOzn9Vut+3FYuHafuaDkapwU2xZ2pweBtt3vV6rMGpVs8J4joDr7Y3rpOLJZKLa/vHxEcbjsSoIticeuE6tSvFkG3ge1TSdTo/X6Dm47YddYxbf7Ki3tzfI5XKQSCTAisViX/46cs4/CFy1WlXJRyIR9RNbFhOidQK32WzUZrvd7qQG1MoIn3zRCZwehPtgkXVw+/3+BBSBNf2X7uMGDs87PadeZAKHuViZTMYmZehqcjNLuqbZbEK/34f393fodrvQarXU50ajoeDpitOTp6put9ujPzq1Kq2ZXunkcXpCOnzyXrNrnFqV8tKBm2peLpdHuFapVLIJ0nd6nzbQq6+r7+npCfL5/Bdw59rgHDjTh9yGg64ksgE3/zPzJNVi4fVhZxaZVBkMBkF5HI11r+DIT+gBMUlscxwSZquiL2BCh8NBnf+u4kzbcAPn5fXCLzjlcX7A3d3dnUxSBENrBA79CH2MAFBb4XmqrlPBLilLB3pu+Dipzm+r+gaHfkATjCZQOBw+UZxp/pSIPrH0xM2peklxugVg4agLzr1HOoEzfdIcSvjKdTJV/SgOb2YaKLUiKe7m5uYIF9ecXilM/3OanuZUJKBOA+3Se6GbJXl6HZH/ObiNkPPrnr9y8bb5/6IEHLOmAk7AMQkww65ecfglH4+Xlxdmij8TdtXgENpsNlOZp1Kpq4J31eAQmCjuZzrm1+569Yr7NTIXNhZwzMoIOAHHJMAME8UJOCYBZpgoTsAxCTDDRHECjkmAGSaKE3BMAswwUZyAYxJghoniBByTADNMFCfgmASYYaI4AcckwAwTxQk4JgFmmChOwDEJMMNEcQKOSYAZJooTcEwCzLBPnQ7QT8ZBGxIAAAAASUVORK5CYII="></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Precision and Recall for test data</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >confMatTest = confusionmat(YTest, YPredTestSet);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >precisionTest = diag(confMatTest) ./ sum(confMatTest, 2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >recallTest = diag(confMatTest) ./ sum(confMatTest, 1)';</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Display Precision and Recall for test data</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Precision for each class (Test):\n'</span><span >);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="052AD0B5" prevent-scroll="true" data-testid="output_9" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Precision for each class (Test):</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >disp(precisionTest);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="FCC8E8C8" prevent-scroll="true" data-testid="output_10" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="76" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">    1.0000
    0.5000
    1.0000
    1.0000
    0.4286</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'Recall for each class (Test):\n'</span><span >);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="80505EED" prevent-scroll="true" data-testid="output_11" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Recall for each class (Test):</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >disp(recallTest);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="2C15E601" prevent-scroll="true" data-testid="output_12" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="76" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">    1.0000
    0.8000
    0.6667
    0.7273
    1.0000</div></div></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%% Testing a New Image After Training</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Load the test image (make sure to replace this path with your test image)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >im = imread(</span><span style="color: rgb(167, 9, 245);">"/MATLAB Drive/Maria.jpg"</span><span >); </span><span style="color: rgb(0, 128, 19);">%make a copy of an image from the Merchdata to Matlab drive</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >im = imresize(im,inputSize(1:2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >X = single(im);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >canUseGPU</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    X = gpuArray(X);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >scores = predict(netTransfer,X);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >[label,score] = scores2label(scores,classNames)</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement" uid="C1E8C84F" prevent-scroll="true" data-testid="output_13" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="35" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " tabindex="-1"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">label = <span class="headerElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">categorical</span></span></div><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">     maria_sharapova 
</div></div></div><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement" uid="3C387E67" prevent-scroll="true" data-testid="output_14" style="width: 858.727px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="35" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " tabindex="-1"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">score = <span class="headerElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">single</span></span>
1.0000</div></div></div></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >imshow(im)</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >title(string(label) + </span><span style="color: rgb(167, 9, 245);">" (Score: " </span><span >+ gather(score) + </span><span style="color: rgb(167, 9, 245);">")"</span><span >)</span></span></div><div  class = 'S5'><img src="data:image/png;base64,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"></div></div><div class="inlineWrapper"><div  class = 'S8'>&nbsp;</div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
imageFolder = '/MATLAB Drive/celebrity_data.zip';
%%
imds = imageDatastore('Celebrity Images', ...
    'IncludeSubfolders',true, ...
    'LabelSource','foldernames');
%%
classNames = categories(imds.Labels)
%%
numClasses = numel(classNames)
%%
labelCount = countEachLabel(imds)
%%
img = readimage(imds,1);
size(img)
%%
numImages = numel(imds.Labels);
idx = randperm(numImages,16);
I = imtile(imds,Frames=idx);
figure
imshow(I)
%%
[imdsTrain,imdsValidation,imdsTest] = splitEachLabel(imds,0.7,0.15,0.15,"randomized");

%%
net = alexnet;
%%
inputSize = net.Layers(1).InputSize;
%%
augimdsTrain = augmentedImageDatastore(inputSize(1:2), imdsTrain, ...
    'DataAugmentation', imageDataAugmenter( ...
        'RandRotation', [-20, 20], ...        % Random rotation
        'RandXTranslation', [-10, 10], ...    % Horizontal translation
        'RandYTranslation', [-10, 10], ...    % Vertical translation
        'RandScale', [0.8, 1.2]), ...         % Scaling
    'ColorPreprocessing', 'gray2rgb');

%%
augimdsVal = augmentedImageDatastore(inputSize(1:2), imdsVal, 'ColorPreprocessing', 'gray2rgb');
%%
layers = net.Layers;
%%
layers(end-2) = fullyConnectedLayer(numel(categories(imdsTrain.Labels)), ...
    'WeightLearnRateFactor',10, 'BiasLearnRateFactor',10);
layers(end) = classificationLayer;
%%
options = trainingOptions('sgdm', ...
    'InitialLearnRate', 0.0005, ...  
    'MaxEpochs', 20, ... 
    'Shuffle', 'every-epoch', ...
    'ValidationData', augimdsVal, ...
    'ValidationFrequency', 30, ...
    'Verbose', false, ...
    'Plots', 'training-progress');

%%
[trainedNet, info] = trainNetwork(augimdsTrain, layers, options);
%%
[YPred, probs] = classify(trainedNet, augimdsVal);
YValidation = imdsVal.Labels;
%%
accuracy = sum(YPred == YValidation) / numel(YValidation);
fprintf('Validation accuracy: %.2f%%\n', accuracy * 100);
%%
figure;
cm = confusionchart(YValidation, YPred);
cm.Title = 'Confusion Matrix for Validation Data';
cm.XLabel = 'Predicted Labels';
cm.YLabel = 'True Labels';
%%
% Precision and Recall
confMat = confusionmat(YValidation, YPred);
precision = diag(confMat) ./ sum(confMat, 2);
recall = diag(confMat) ./ sum(confMat, 1)';
%%
% Display Precision and Recall
fprintf('Precision for each class:\n');
disp(precision);
fprintf('Recall for each class:\n');
disp(recall);
overallPrecision = mean(precision);
overallRecall = mean(recall);
fprintf('Overall Precision: %.2f%%\n', overallPrecision * 100);
fprintf('Overall Recall: %.2f%%\n', overallRecall * 100);
%%
augimdsTest = augmentedImageDatastore(inputSize(1:2), imdsTest, 'ColorPreprocessing', 'gray2rgb');
%%
YPredTestSet = classify(trainedNet, augimdsTest);
%%
YTest = imdsTest.Labels;
%%
estAccuracy = sum(YPredTestSet == YTest) / numel(YTest);
fprintf('Test accuracy: %.2f%%\n', testAccuracy * 100);
%%
figure;
cmTest = confusionchart(YTest, YPredTestSet);
cmTest.Title = 'Confusion Matrix for Test Data';
cmTest.XLabel = 'Predicted Labels';
cmTest.YLabel = 'True Labels';
%%
% Precision and Recall for test data
confMatTest = confusionmat(YTest, YPredTestSet);
precisionTest = diag(confMatTest) ./ sum(confMatTest, 2);
recallTest = diag(confMatTest) ./ sum(confMatTest, 1)';
%%
% Display Precision and Recall for test data
fprintf('Precision for each class (Test):\n');
disp(precisionTest);
fprintf('Recall for each class (Test):\n');
disp(recallTest);
%%
%% Testing a New Image After Training
% Load the test image (make sure to replace this path with your test image)
im = imread("/MATLAB Drive/Maria.jpg"); %make a copy of an image from the Merchdata to Matlab drive
im = imresize(im,inputSize(1:2));
X = single(im);
%%
if canUseGPU
    X = gpuArray(X);
end
scores = predict(netTransfer,X);
[label,score] = scores2label(scores,classNames)
%%
figure
imshow(im)
title(string(label) + " (Score: " + gather(score) + ")")
##### SOURCE END #####
-->
</div></body></html>